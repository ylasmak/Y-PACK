var express =  require('express'),
		mongoose = require('mongoose'),
		jsonSchema = require('../').modelToJSONSchema;
		
require('./support/node');

var app = express();

app.get('/meta/schemas/:schema', function (req, res) {
	var model = mongoose.models[req.params.schema];
	
	if (model) {
		res.set({
			'Content-Type': 'application/schema+json'
		}).send(jsonSchema(model)).end();
	} else {
		res.status(404).end();
	}
});

app.listen(8087, function () {
	console.log('listening');
});